# GitHub Actions CI/CD é…ç½®æŒ‡å—

## ğŸ¯ æ¦‚è¿°

ä¸º Enhanced TradingAgents é¡¹ç›®é…ç½®äº†å®Œæ•´çš„ CI/CD æµæ°´çº¿ï¼ŒåŒ…æ‹¬ï¼š

- âœ… **ä»£ç è´¨é‡æ£€æŸ¥** - æ ¼å¼åŒ–ã€ä»£ç æ£€æŸ¥ã€å¤æ‚åº¦åˆ†æ
- âœ… **è‡ªåŠ¨åŒ–æµ‹è¯•** - å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€APIæµ‹è¯•
- âœ… **å®‰å…¨æ‰«æ** - ä¾èµ–æ£€æŸ¥ã€ä»£ç å®‰å…¨ã€ç§˜é’¥æ‰«æ
- âœ… **å¤šå¹³å°æ”¯æŒ** - Ubuntuã€macOSã€Windows
- âœ… **æ€§èƒ½æµ‹è¯•** - å†…å­˜æ£€æŸ¥ã€åŸºå‡†æµ‹è¯•

## ğŸ“ å·¥ä½œæµæ–‡ä»¶

```
.github/workflows/
â”œâ”€â”€ ci.yml              # ä¸»CI/CDæµæ°´çº¿
â”œâ”€â”€ test-suite.yml      # è¯¦ç»†æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ code-quality.yml    # ä»£ç è´¨é‡æ£€æŸ¥
â””â”€â”€ security.yml        # å®‰å…¨æ‰«æ
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è®¾ç½®ä»“åº“ç§˜é’¥

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ Secretsï¼š

```bash
# å¿…éœ€çš„APIç§˜é’¥
OPENAI_API_KEY=your_openai_key
FINNHUB_API_KEY=your_finnhub_key

# å¯é€‰çš„APIç§˜é’¥
DEEPSEEK_API_KEY=your_deepseek_key
```

### 2. æœ¬åœ°å¼€å‘å·¥å…·å®‰è£…

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# å®‰è£…pre-commité’©å­
pre-commit install

# æ‰‹åŠ¨è¿è¡Œä»£ç æ ¼å¼åŒ–
black .
isort .
```

### 3. æœ¬åœ°æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥
flake8 .
mypy tradingagents/ extensions/
bandit -r tradingagents/ extensions/
```

## ğŸ”„ å·¥ä½œæµè§¦å‘æ¡ä»¶

### ä¸»CIæµæ°´çº¿ (ci.yml)
- **æ¨é€åˆ°**: `main`, `develop`, `pr/*` åˆ†æ”¯
- **PRåˆ°**: `main`, `develop` åˆ†æ”¯  
- **å®šæ—¶è¿è¡Œ**: æ¯æ—¥ 2:00 AM UTC

### æµ‹è¯•å¥—ä»¶ (test-suite.yml)
- **æ–‡ä»¶å˜æ›´**: `tradingagents/`, `extensions/`, `tests/`, `requirements.txt`
- **PR**: ä»»ä½•å¯¹ä¸Šè¿°è·¯å¾„çš„ä¿®æ”¹

### ä»£ç è´¨é‡ (code-quality.yml)
- **æ¨é€/PRåˆ°**: `main`, `develop` åˆ†æ”¯

### å®‰å…¨æ‰«æ (security.yml)
- **æ¨é€/PRåˆ°**: `main`, `develop` åˆ†æ”¯
- **å®šæ—¶è¿è¡Œ**: æ¯å‘¨æ—¥ 3:00 AM UTC

## ğŸ“Š æµ‹è¯•çŸ©é˜µ

| æ“ä½œç³»ç»Ÿ | Pythonç‰ˆæœ¬ | æµ‹è¯•ç±»å‹ |
|----------|-------------|----------|
| Ubuntu | 3.11, 3.12 | å•å…ƒ+é›†æˆ |
| macOS | 3.11, 3.12 | å•å…ƒ+é›†æˆ |
| Windows | 3.11 | å•å…ƒ |

## ğŸ›¡ï¸ å®‰å…¨æ£€æŸ¥

### ä¾èµ–å®‰å…¨
- **Safety**: PythonåŒ…æ¼æ´æ‰«æ
- **pip-audit**: ä¾èµ–å®¡è®¡
- **Bandit**: ä»£ç å®‰å…¨æ‰«æ

### ç§˜é’¥æ£€æµ‹
- **TruffleHog**: Gitå†å²ç§˜é’¥æ‰«æ
- **è‡ªå®šä¹‰è§„åˆ™**: API keyæ¨¡å¼æ£€æµ‹

### å®¹å™¨å®‰å…¨
- **Trivy**: Dockeré•œåƒæ¼æ´æ‰«æ

## ğŸ“ˆ ä»£ç è´¨é‡é—¨ç¦

### å¿…é¡»é€šè¿‡çš„æ£€æŸ¥
- âœ… ä»£ç æ ¼å¼åŒ– (Black)
- âœ… å¯¼å…¥æ’åº (isort)
- âœ… åŸºæœ¬è¯­æ³•æ£€æŸ¥ (flake8)
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡
- âœ… Dockeræ„å»ºæˆåŠŸ

### è­¦å‘Šçº§åˆ«æ£€æŸ¥
- âš ï¸ ç±»å‹æ£€æŸ¥ (mypy)
- âš ï¸ ä»£ç å¤æ‚åº¦ (radon)
- âš ï¸ æ–‡æ¡£è¦†ç›–ç‡ (interrogate)
- âš ï¸ å®‰å…¨æ‰«æç»“æœ

## ğŸ—ï¸ Docker æµ‹è¯•ç¯å¢ƒ

### æµ‹è¯•æœåŠ¡é…ç½®
```yaml
services:
  - Redis (ç¼“å­˜)
  - PostgreSQL (æ•°æ®åº“)
  - ä¸»åº”ç”¨ (æµ‹è¯•æ¨¡å¼)
```

### æœ¬åœ°è¿è¡Œæµ‹è¯•ç¯å¢ƒ
```bash
cd deployment/docker
docker-compose -f docker-compose.test.yml up
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æµ‹è¯•å¤±è´¥ï¼šAPIå¯†é’¥é”™è¯¯
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥GitHub Secretsé…ç½®
# æˆ–åœ¨æœ¬åœ°è®¾ç½®ç¯å¢ƒå˜é‡
export OPENAI_API_KEY="your-key"
export FINNHUB_API_KEY="your-key"
```

#### 2. ä»£ç æ ¼å¼åŒ–å¤±è´¥
```bash
# è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œæ ¼å¼åŒ–å·¥å…·
black .
isort .
git add .
git commit -m "Fix formatting"
```

#### 3. ä¾èµ–å®‰å…¨è­¦å‘Š
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ›´æ–°ä¾èµ–
pip install --upgrade package-name
# æˆ–æ·»åŠ ä¾‹å¤–åˆ° .pipignore
```

#### 4. Dockeræ„å»ºå¤±è´¥
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥Dockerfileå’Œä¾èµ–
cd deployment/docker
docker build -t test-image .
```

## ğŸ“‹ æœ€ä½³å®è·µ

### 1. æäº¤å‰æ£€æŸ¥
```bash
# è¿è¡Œpre-commité’©å­
pre-commit run --all-files

# å¿«é€Ÿæµ‹è¯•
pytest tests/test_quick.py -v
```

### 2. PRåˆ›å»º
- ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
- æ·»åŠ é€‚å½“çš„æµ‹è¯•
- æ›´æ–°æ–‡æ¡£ï¼ˆå¦‚éœ€è¦ï¼‰
- ä½¿ç”¨æè¿°æ€§çš„commitæ¶ˆæ¯

### 3. æ€§èƒ½è€ƒè™‘
- ä½¿ç”¨ `[perf]` æ ‡ç­¾è§¦å‘æ€§èƒ½æµ‹è¯•
- ç›‘æ§æµ‹è¯•æ‰§è¡Œæ—¶é—´
- é¿å…åœ¨CIä¸­è¿è¡Œé•¿æ—¶é—´æµ‹è¯•

### 4. å®‰å…¨æ³¨æ„äº‹é¡¹
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç APIå¯†é’¥
- ä½¿ç”¨GitHub Secretsç®¡ç†æ•æ„Ÿä¿¡æ¯
- å®šæœŸæ›´æ–°ä¾èµ–
- å…³æ³¨å®‰å…¨æ‰«æç»“æœ

## ğŸ“š å‚è€ƒèµ„æº

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [pytest æ–‡æ¡£](https://docs.pytest.org/)
- [Black ä»£ç æ ¼å¼åŒ–](https://black.readthedocs.io/)
- [Docker æœ€ä½³å®è·µ](https://docs.docker.com/develop/dev-best-practices/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¡®ä¿æ‰€æœ‰CIæ£€æŸ¥é€šè¿‡
4. åˆ›å»ºPRå¹¶ç­‰å¾…å®¡æ ¸
5. åˆå¹¶åè‡ªåŠ¨éƒ¨ç½²

---

**æ³¨æ„**: è¿™äº›å·¥ä½œæµé…ç½®é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ï¼ŒåŒ…å«å®Œæ•´çš„æµ‹è¯•ã€å®‰å…¨å’Œè´¨é‡æ£€æŸ¥ã€‚å¯¹äºå¿«é€Ÿå¼€å‘ï¼Œå¯ä»¥åˆ›å»ºç®€åŒ–ç‰ˆæœ¬çš„å·¥ä½œæµã€‚